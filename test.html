<? include("header/header.html");?>
<? include("header/menu.html"); ?>
<?$item = 1;?>
<?include('data/report.php');?>

<!-- IE8 에서 HTML5 요소와 미디어 쿼리를 위한 HTML5 shim 와 Respond.js -->
<!-- WARNING: Respond.js 는 당신이 file:// 을 통해 페이지를 볼 때는 동작하지 않습니다. -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<link href="css/dataTables.bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/fixedcolumns/3.3.0/js/dataTables.fixedColumns.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#recode_hitplay1').DataTable({
    	// 표시 건수기능 숨기기
        lengthChange: false,
        // 검색 기능 숨기기
        searching: false,
        // 페이징 기능 숨기기
        paging: false,

    });
    $('#recode_pitchplay').DataTable({
        // 표시 건수기능 숨기기
        lengthChange: false,
        // 검색 기능 숨기기
        searching: false,
        // 페이징 기능 숨기기
        paging: false,
    });
} );
</script>

<div class="ro_subpage">	
	<div class="container record_contents">
		<div class="to_mb_40">
			<div class="col-xs-12 col-md-6 text-left">
				<div class="to_titlebar">
					선수정보
				</div>
			</div>
			<div class="col-xs-12 col-md-3"></div>
			<div class="col-xs-12 col-md-3 text-right record_select_kinds">
				<form>
					<select class="rounded shadow" id="select_kind" onchange="change_kind()">
						<option value="" selected>공식기록</option>
						<option value="2">비공식기록</option>
						<option value="3">연습·용병기록</option>
					</select>
				</form>
			</div>
		</div>
		<hr>
		<div class="to_page_content2 to_mb_30 table-responsive rounded shadow">
			<table class="table recode_player_table">
				<tr>
					<td>
						<div class="recode_player"><img src="<?=$user_img?>" class="d-inline-block align-top rounded-circle" style=""> No. <span><?=$player_row['back_num']?></span><?=$user_row['name']?></div>
						<div class="recode_player_info_table table-responsive">
							<table class="table">
								<tr>
									<th>소속팀</th><td><?=$team_name?></td>
									<th>주활동지역</th><td><?=$address?></td>
									<th>주활동리그</th><td><?=$playerclass?></td>
									
								</tr>
								<tr>
									<th>나이</th><td><?=$age?></td>
									<th>신장/체중</th><td><?=$playertall?> / <?=$playerweight?></td>
									<th>주포지션</th><td><?=$position?></td>
								</tr>
								<tr>
									<th>선출여부</th><td><?=$playercheck?></td>
									<th>투/타</th><td><?=$hitpitch?></td>
								</tr>
							</table>
						</div>
					</td>
				</tr>
			</table>
		</div><!-- 선수 정보 끝 -->
		<?if($hit_table_basic){ ?>
        <div class="row">
            <div class="to_titlebar to_mb_10">
                타자 - 평점모형
            </div>
            <hr>
            <div class="table-responsive to_mb_30 rounded shadow">
                <table class="table table_h_b record_table">
                    <tr>
                        <th>리그</th><th>타율</th><th>경기</th><th>타수</th><th>안타</th><th>홈런</th><th>볼넷</th><th>득점</th><th>타점</th><th>도루</th><th>출루율</th><th>장타율</th><th>OPS</th>
                    </tr>
                    <tr>
                        <?=$hit_table_summary;?>
                    </tr>
                </table>
            </div>
            <div class="col-md-3 col-xs-12">
                <div class="to_border rounded shadow">
                    <canvas id="model_pie" width="100%" height="<?=$model_pie?>"></canvas>
                </div>
            </div>
            <div class="col-md-3 col-xs-12">
                <div class="to_border rounded shadow">
                    <canvas id="model_radar" width="100%" height="100%"></canvas>
                </div>
            </div>
            <div class="col-md-6 col-xs-12">
                <div class="to_border rounded shadow">
                    <canvas id="model_bar" width="100%" height="<?=$model_bar?>"></canvas>
                </div>
            </div>
            <div class="col-md-12 col-xs-12">
                <div class="to_border rounded shadow" style="padding:20px">
                     '<?=$user_row['name']?>'님은 스포지지가 보유한 리그 기록 중 상위 <?=$pie_chart_data?>%에 속합니다.
                </div>
            </div>
            <div class="col-md-12 col-xs-12">
                <div class="to_border heatmap_chart rounded shadow">
                    <table>
                        <thead>
                            <tr>
                                <th>파워</th><th>정확성</th><th>선구안</th><th>주루</th><th>스타성</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="background-color:<?=$heatmap_color_table[0]?>;">2루타<br><br><br><?=$heatmap_text_table[0]?></td><td style="background-color:<?=$heatmap_color_table[4]?>;">안타<br><br><br><?=$heatmap_text_table[4]?></td><td style="background-color:<?=$heatmap_color_table[8]?>;">볼넷<br><br><br><?=$heatmap_text_table[8]?></td><td style="background-color:<?=$heatmap_color_table[12]?>;">도루<br><br><br><?=$heatmap_text_table[12]?></td><td style="background-color:<?=$heatmap_color_table[16]?>;">경기<br><br><br><?=$heatmap_text_table[16]?></td></tr>
                            <tr><td style="background-color:<?=$heatmap_color_table[1]?>;">장타<br><br><br><?=$heatmap_text_table[1]?></td><td style="background-color:<?=$heatmap_color_table[5]?>;">타율<br><br><br><?=$heatmap_text_table[5]?></td><td style="background-color:<?=$heatmap_color_table[9]?>;">삼진<br><br><br><?=$heatmap_text_table[9]?></td><td style="background-color:<?=$heatmap_color_table[13]?>;">3루타<br><br><br><?=$heatmap_text_table[13]?></td><td style="background-color:<?=$heatmap_color_table[17]?>;">타점<br><br><br><?=$heatmap_text_table[17]?></td></tr>
                            <tr><td style="background-color:<?=$heatmap_color_table[2]?>;">장타율<br><br><br><?=$heatmap_text_table[2]?></td><td style="background-color:<?=$heatmap_color_table[6]?>;">희생타<br><br><br><?=$heatmap_text_table[6]?></td><td style="background-color:<?=$heatmap_color_table[10]?>;">볼넷/삼진<br><br><br><?=$heatmap_text_table[10]?></td><td style="background-color:<?=$heatmap_color_table[14]?>;">득점<br><br><br><?=$heatmap_text_table[14]?></td><td style="background-color:<?=$heatmap_color_table[18]?>;">홈런<br><br><br><?=$heatmap_text_table[18]?></td></tr>
                            <tr><td style="background-color:<?=$heatmap_color_table[3]?>;">순장타율<br><br><br><?=$heatmap_text_table[3]?></td><td style="background-color:<?=$heatmap_color_table[7]?>;">컨택성공율<br><br><br><?=$heatmap_text_table[7]?></td><td style="background-color:<?=$heatmap_color_table[11]?>;">삼진율<br><br><br><?=$heatmap_text_table[11]?></td><td style="background-color:<?=$heatmap_color_table[15]?>;">출루율<br><br><br><?=$heatmap_text_table[15]?></td><td style="background-color:<?=$heatmap_color_table[19]?>;">OPS<br><br><br><?=$heatmap_text_table[19]?></td></tr>
                        </tbody>
                    </table>
                    <table class="heatmap_color_table">
                        <tr>
                            <td style="background-color:<?=$heatmap_color[0]?>;">SSS</td>
                            <td style="background-color:<?=$heatmap_color[1]?>;">SS</td>
                            <td style="background-color:<?=$heatmap_color[2]?>;">S</td>
                            <td style="background-color:<?=$heatmap_color[3]?>;">A+</td>
                            <td style="background-color:<?=$heatmap_color[4]?>;">A</td>
                            <td style="background-color:<?=$heatmap_color[5]?>;">B+</td>
                            <td style="background-color:<?=$heatmap_color[6]?>;">B</td>
                            <td style="background-color:<?=$heatmap_color[7]?>;">C</td>
                            <td style="background-color:<?=$heatmap_color[8]?>;">D</td>
                            <td style="background-color:<?=$heatmap_color[9]?>;">F</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
		<?if($year_chart_5years){?>
        <div class="row">
            <div class="to_titlebar to_mb_10">
                최근 5년 기록 요약
            </div>
            <hr>
            <div class="table-responsive to_mb_30 rounded shadow">
                <table class="table table_h_b">
                    <tr>
                        <th>년도</th><th>리그</th><th>타율</th><th>경기</th><th>타수</th><th>안타</th><th>홈런</th><th>볼넷</th><th>득점</th><th>타점</th><th>도루</th><th>출루율</th><th>장타율</th><th>OPS</th>
                    </tr>
                    <?=$hit_table_5years?>
                </table>
            </div>
            <div class="to_mb_30">
                <div class="col-md-6 col-xs-12">
                    <div class="to_border rounded shadow">
                        <canvas id="years_5_avg" width="100%" height="<?=$years_5_height;?>"></canvas>
                    </div>
                </div>
                <div class="col-md-6 col-xs-12">
                    <div class="to_border rounded shadow">
                        <canvas id="years_5_ops" width="100%" height="<?=$years_5_height;?>"></canvas>
                    </div>
                </div>
                <div class="col-md-12 col-xs-12">
                
                </div>
            </div>
        </div>
		<? } ?>
        <div class="row">
            <div class="to_titlebar to_mb_10">
            추천 서비스
            </div>
            <hr>
            <div class="swiper-container">
                <div class="swiper-wrapper main_promotion" style="margin:15px 0px 20px 0px;">
					<?=$promotion_list?>
				</div>
                <!-- Add Pagination -->
                <div class="swiper-pagination"></div>
                <? if(!$isMobile){ ?>
                <!-- Add Arrows -->
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
                <? } ?>
            </div>
        </div>
		<? } ?>
		<?if($hit_table_basic){ ?>
		<div class="to_titlebar">
			누적 기록
		</div>
		<hr>
		<div class="table-box-wrap">
			<div class="table-responsive to_mb_30 table-box rounded shadow">
				<table class="table table_h_b recode_hitplay ro_table_12" id="recode_hitplay1">
					<thead>
						<tr>
							<th>No</th><th>년도</th><th>리그명</th><th>팀명</th><th>타율</th><th>경기</th><th>타석</th><th>타수</th><th>안타</th><th>2루타</th><th>3루타</th><th>홈런</th><th>타점</th><th>득점</th><th>도루</th><th>볼넷</th><th>사사구</th><th>삼진</th><th>희생</th><th>루타</th><th>장타</th><th>출루율</th><th>장타율</th><th>OPS</th><th>삭제</th>
						</tr>
					</thead>
					<tbody>
						<?=$hit_table_basic;?>
					</tbody>				
				</table>
			</div>
		</div>
		<?}?>
		<?if($pit_table_basic){ ?>
		<div class="to_titlebar">
			기록요약 - 투수
		</div>
		<hr>
		<div class="table-responsive to_mb_30 ">
			<table class="table table_h_b">
				<thead>
					<tr>
						<th>리그</th><th>평균자책점</th><th>실점율</th><th>경기</th><th>승</th><th>패</th><th>승률</th><th>자책</th><th>실점</th><th>이닝</th><th>피안타</th><th>탈삼진</th><th>출루허용율</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<?=$pit_table_summary;?>
					</tr>							
				</tbody>
			</table>
		</div>
		<? } ?>
		<?if($pit_table_basic){ ?>
		<div class="to_titlebar">
			기본기록 - 투수
		</div>
		<hr>
		<div class="table-box-wrap">
			<div class="table-responsive to_mb_30 table-box">
				<table class="table table_h_b recode_pitcherplay ro_table_12" id="recode_pitchplay">
					<thead>
						<tr>
							<th>No</th><th>년도</th><th>리그명</th><th>팀명</th><th>평균자책점</th><th>실점율</th><th>경기</th><th>승</th><th>패</th><th>홀</th><th>세</th><th>투구</th><th>이닝</th><th>자책</th><th>실점</th><th>피안타</th><th>피홈런</th><th>볼넷</th><th>사사구</th><th>탈삼진</th><th>승률</th><th>출루허용율</th><th>삭제</th>
						</tr>
					</thead>
					<tbody>
						<?=$pit_table_basic;?>
					</tbody>				
				</table>
			</div>
		</div>
		<? } ?>	
	</div>
</div>
<script src="js/swiper.min.js"></script>
<!-- Initialize Swiper -->
<script>
    var swiper = new Swiper('.swiper-container', {
		slidesPerView: 3,
		spaceBetween: 30,
		pagination: {
			el: '.swiper-pagination',
			clickable: true,
		},
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev',
		},
    });
</script>
<script>
function read_promotion(no){
    window.open("read_promotion.html?no="+no,
    "update_promotion","left=200, top=100, width=500, height=800, scrollbars=no,resizable=yes");
    //document.getElementById("id").disabled = true;
}
</script>
<script>
function delete_event(no){
	if (confirm("정말 삭제하시겠습니까?") == true){
		location.href="LeagueRecordDeleteProc.php?no="+no;
	}else{ 
		return;
	}
}
function change_kind(){
	var selectkind = document.getElementById("select_kind");
	var selectedValue = selectkind.options[selectkind.selectedIndex].value;
	if(selectedValue == 1){
		location.href = "test.html";
	}else if(selectedValue == 2){
		location.href = "test2.html";
	}else if(selectedValue == 3){
		location.href = "test3.html";
	}
}
Chart.pluginService.register({
	beforeDraw: function (chart) {
		if (chart.config.options.elements.center) {
			//Get ctx from string
			var ctx = chart.chart.ctx;

			//Get options from the center object in options
			var centerConfig = chart.config.options.elements.center;
			var fontStyle = centerConfig.fontStyle || 'Arial';
			var txt = centerConfig.text;
			var color = centerConfig.color || '#000';
			var sidePadding = centerConfig.sidePadding || 20;
			var sidePaddingCalculated = (sidePadding/100) * (chart.innerRadius * 2)
			//Start with a base font of 30px
			ctx.font = "30px " + fontStyle;

			//Get the width of the string and also the width of the element minus 10 to give it 5px side padding
			var stringWidth = ctx.measureText(txt).width;
			var elementWidth = (chart.innerRadius * 2) - sidePaddingCalculated;

			// Find out how much the font can grow in width.
			var widthRatio = elementWidth / stringWidth;
			var newFontSize = Math.floor(30 * widthRatio);
			var elementHeight = (chart.innerRadius * 2);

			// Pick a new font size so it will not be larger than the height of label.
			var fontSizeToUse = Math.min(newFontSize, elementHeight);

			//Set font settings to draw it correctly.
			ctx.textAlign = 'center';
			ctx.textBaseline = 'middle';
			var centerX = ((chart.chartArea.left + chart.chartArea.right) / 2);
			var centerY = ((chart.chartArea.top + chart.chartArea.bottom) / 2);
			ctx.font = fontSizeToUse+"px " + fontStyle;
			ctx.fillStyle = color;

			//Draw text in center
			ctx.fillText(txt, centerX, centerY);
		}
	}
});
var ctx2 = document.getElementById('model_radar');
var myRadarChart = new Chart(ctx2, {
    type: 'radar',
    data: {
		labels: ['파워', '정확성', '선구안', '주루', '스타성'],
		datasets: [{
			label: '내 기록',
			data: [<?=$lader_chart_data?>],
			backgroundColor : 'rgba(0, 0, 255, 0.3)',
			borderColor: 'rgba(0, 0, 255, 0.7)',
			pointBackgroundColor: 'rgba(0, 0, 255, 0.7)',
			pointBorderColor: '#fff'
			
		},{
			label: '리그 평균',
			data: [6.5, 4.5, 5.5, 5.5, 4.75],
			backgroundColor: 'rgba(179, 181, 198, 0.2)',
            borderColor: 'rgba(179, 181, 198, 0.7)',
            pointBackgroundColor: 'rgba(179, 181, 198, 0.7)',
            pointBorderColor: '#fff'
		}]
	},
    options : {
		scale: {
			ticks: {
				suggestedMin: 0,
				suggestedMax: 10,
				fontFamily: 'Do Hyeon',
				fontSize: 15
			},pointLabels: {
				fontFamily: 'Do Hyeon',
				fontSize: 17
			}
		},
		title: {
            display: false,
            text: '그래프1',
			fontFamily: 'Do Hyeon',
			position: 'top',
			fontSize: 20
        },
		elements: {
			line: {
				tension:0,
				borderWidth:3
			}
		},
		tooltips: {
			enabled: false
		}
	}
});
var ctx2 = document.getElementById('model_bar');
var myBarChart = new Chart(ctx2, {
    type: 'horizontalBar',
    data: {
		labels: ['타율', 'OPS', '볼넷/삼진', '삼진율', '컨택성공율'],
		datasets: [{
			data: [<?=$hit_chart_summary?>],
			label: '내 기록',
			backgroundColor : 'rgba(0, 0, 255, 0.7)'
		},{
			data: [0.376, 0.999, 1.12, 0.29, 0.819],
			label: '리그 평균',
			backgroundColor: 'rgba(179, 181, 198, 0.7)'
		}]
	},
	options: {
		title: {
            display: false,
            text: '그래프2',
			fontFamily: 'Do Hyeon',
			position: 'top',
			fontSize: 20
        }
	}
});
var ctx = document.getElementById('model_pie');
var myDoughnutChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
		datasets: [{
			data: [<?=(100-$pie_chart_data)?>, <?=$pie_chart_data?>],
			backgroundColor: [
                'rgba(0, 0, 255, 0.6)'
            ],
		}]
	},
	options: {
        legend: {
            display: false
		},
		responsive: true,
		display : "inline-block",
		tooltips: {
			enabled: false
		},
		elements: {
			center: {
			text: '<?=($pie_chart_data)?>%',
			color: 'rgba(0, 0, 255, 0.6)', //Default black
			fontStyle: 'Do Hyeon', //Default Arial
			sidePadding: 15 //Default 20 (as a percentage)
			}
		},
		title: {
            display: false,
            text: '그래프3',
			fontFamily: 'Do Hyeon',
			position: 'top',
			fontSize: 20
        }
	}
});
<?if($year_chart_5years){?>
var ctx2 = document.getElementById('years_5_avg');
var myLineChart = new Chart(ctx2, {
    type: 'line',
    data: {
		labels : [<?=$year_chart_5years?>],
		datasets : [{
			data : [<?=$avg_chart_5years?>],
			label: '타율',
			backgroundColor : 'rgba(0, 0, 255, 0.8)',
			borderColor: 'rgba(0, 0, 255, 0.6)',
			fill : false
		},{
			data : [<?=$league_avg_chart_5years?>],
			label: '리그평균',
			backgroundColor: 'rgba(179, 181, 198, 0.8)',
			borderColor: 'rgba(179, 181, 198, 0.6)',
			fill : false
		}]
	},
	options: {
		title: {
            display: false,
            text: '최근 5년 타율',
			fontFamily: 'Do Hyeon',
			position: 'top',
			fontSize: 20
        },
		tooltips: {
			mode: 'index',
			intersect: false
		}
	}
});
var ctx2 = document.getElementById('years_5_ops');
var myBarChart = new Chart(ctx2, {
    type: 'bar',
    data: {
		labels : [<?=$year_chart_5years?>],
		datasets: [{
			data: [<?=$ops_chart_5years?>],
			stack: 'Stack 1',
			label: 'OPS',
			type: 'line',
			fill: false,
			backgroundColor : 'rgba(255, 99, 132, 1)',
			borderColor: 'rgba(255, 99, 132, 0.7)'
		},{
			data: [<?=$slg_chart_5years?>],
			stack: 'Stack 0',
			label: '장타율',
			backgroundColor : 'rgba(54, 162, 235, 1)'
		},{
			data: [<?=$obp_chart_5years?>],
			stack: 'Stack 0',
			label: '출루율',
			backgroundColor : 'rgba(75, 192, 192, 1)'
		}]
	},
	options: {
		scales: {
		   xAxes: [{
				stacked: true
		   }]
	   },
		title: {
            display: false,
            text: '그래프5',
			fontFamily: 'Do Hyeon',
			position: 'top',
			fontSize: 20
        },
		tooltips: {
			mode: 'index',
			intersect: false
		}
	}
});
<? } ?>
</script>
<? include("footer/footer.html"); ?>
</body>
</html>